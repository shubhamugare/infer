{"id": "interprocedural_001", "source_file": "pulse/interprocedural.c", "original_function_name": "conditional_free", "anonymized_function_name": "test_function_001", "function_code": "void test_function_001(int x, int* y) {\n  if (x > 5) {\n    free(y);\n  }\n}\n", "includes": ["#include <stdlib.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 9, "end_line": 13}}
{"id": "interprocedural_002", "source_file": "pulse/interprocedural.c", "original_function_name": "conditional_free_then_use_latent", "anonymized_function_name": "test_function_002", "function_code": "void test_function_002(int x) {\n  int* y = (int*)malloc(sizeof(int));\n  conditional_free(x, y);\n  if (y != NULL) {\n    // arguably we should report here since the code is bad, but the current\n    // heuristic classifies this as latent\n    *y = 1;\n  }\n  // avoid memory leak\n  if (x <= 5) {\n    free(y);\n  }\n}\n", "includes": ["#include <stdlib.h>"], "dependencies": ["conditional_free"], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "USE_AFTER_FREE_LATENT", "line_offset": 6, "absolute_line": 21, "severity": "ERROR", "trace": "invalidation part of the trace starts here,allocated by call to `malloc` (modelled),assigned,when calling `conditional_free` here,parameter `y` of conditional_free,was invalidated by call to `free()`,use-after-lifetime part of the trace starts here,allocated by call to `malloc` (modelled),assigned,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "other", "start_line": 15, "end_line": 27}}
{"id": "interprocedural_003", "source_file": "pulse/interprocedural.c", "original_function_name": "call_conditional_free_then_use_bad", "anonymized_function_name": "test_function_003", "function_code": "void test_function_003() {\n  conditional_free_then_use_latent(7);\n}\n", "includes": ["#include <stdlib.h>"], "dependencies": ["conditional_free_then_use_latent"], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "USE_AFTER_FREE", "line_offset": 1, "absolute_line": 30, "severity": "ERROR", "trace": "invalidation part of the trace starts here,allocated by call to `malloc` (modelled),assigned,when calling `conditional_free` here,parameter `y` of conditional_free,was invalidated by call to `free()`,use-after-lifetime part of the trace starts here,when calling `conditional_free_then_use_latent` here,allocated by call to `malloc` (modelled),assigned,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "use_after_free", "start_line": 29, "end_line": 31}}
{"id": "interprocedural_004", "source_file": "pulse/interprocedural.c", "original_function_name": "test_modified_value_then_error_bad", "anonymized_function_name": "test_function_004", "function_code": "void test_function_004(int* x) {\n  *x = random();\n  if (*x == 5) {\n    int* p = NULL;\n    *p = 42;\n  }\n}\n", "includes": ["#include <stdlib.h>"], "dependencies": [], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 4, "absolute_line": 39, "severity": "ERROR", "trace": "is assigned to the null pointer,assigned,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "nullptr_dereference", "start_line": 35, "end_line": 41}}
{"id": "interprocedural_005", "source_file": "pulse/interprocedural.c", "original_function_name": "latent_dereference", "anonymized_function_name": "test_function_005", "function_code": "void test_function_005(int a, int* p) {\n  if (a == 4) {\n    *p = 42;\n  }\n}\n", "includes": ["#include <stdlib.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 46, "end_line": 50}}
{"id": "interprocedural_006", "source_file": "pulse/interprocedural.c", "original_function_name": "propagate_latent_1_latent", "anonymized_function_name": "test_function_006", "function_code": "void test_function_006(int a1) { latent_dereference(a1, NULL); }\n", "includes": ["#include <stdlib.h>"], "dependencies": ["latent_dereference"], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE_LATENT", "line_offset": 0, "absolute_line": 52, "severity": "ERROR", "trace": "is assigned to the null pointer,when calling `latent_dereference` here,parameter `p` of latent_dereference,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "other", "start_line": 52, "end_line": 52}}
{"id": "interprocedural_007", "source_file": "pulse/interprocedural.c", "original_function_name": "propagate_latent_2_latent", "anonymized_function_name": "test_function_007", "function_code": "void test_function_007(int a2) { propagate_latent_1_latent(a2); }\n", "includes": ["#include <stdlib.h>"], "dependencies": ["propagate_latent_1_latent"], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "safe", "start_line": 54, "end_line": 54}}
{"id": "interprocedural_008", "source_file": "pulse/interprocedural.c", "original_function_name": "propagate_latent_3_latent", "anonymized_function_name": "test_function_008", "function_code": "void test_function_008(int a3) { propagate_latent_2_latent(a3); }\n", "includes": ["#include <stdlib.h>"], "dependencies": ["propagate_latent_2_latent"], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "safe", "start_line": 56, "end_line": 56}}
{"id": "interprocedural_009", "source_file": "pulse/interprocedural.c", "original_function_name": "make_latent_manifest", "anonymized_function_name": "test_function_009", "function_code": "void test_function_009() { propagate_latent_3_latent(4); }\n", "includes": ["#include <stdlib.h>"], "dependencies": ["propagate_latent_3_latent"], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 0, "absolute_line": 58, "severity": "ERROR", "trace": "when calling `propagate_latent_3_latent` here,when calling `propagate_latent_2_latent` here,when calling `propagate_latent_1_latent` here,is assigned to the null pointer,when calling `latent_dereference` here,parameter `p` of latent_dereference,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "nullptr_dereference", "start_line": 58, "end_line": 58}}
{"id": "interprocedural_010", "source_file": "pulse/interprocedural.c", "original_function_name": "return_first", "anonymized_function_name": "test_function_010", "function_code": "int* test_function_010(int* x, int a, int** out) {\n  int* w = x;\n  *out = w;\n  return w;\n}\n", "includes": ["#include <stdlib.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 60, "end_line": 64}}
{"id": "interprocedural_011", "source_file": "pulse/interprocedural.c", "original_function_name": "return_null", "anonymized_function_name": "test_function_011", "function_code": "int* test_function_011(int** out) {\n  int* p = NULL;\n  *out = p;\n  return p;\n}\n", "includes": ["#include <stdlib.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 66, "end_line": 70}}
{"id": "interprocedural_012", "source_file": "pulse/interprocedural.c", "original_function_name": "follow_value_by_ref_bad", "anonymized_function_name": "test_function_012", "function_code": "void test_function_012() {\n  int* y;\n  return_null(&y);\n  int* z;\n  return_first(y, 12, &z);\n  *z = 42;\n}\n", "includes": ["#include <stdlib.h>"], "dependencies": ["return_first", "return_null"], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 5, "absolute_line": 78, "severity": "ERROR", "trace": "in call to `return_null`,is assigned to the null pointer,assigned,assigned,return from call to `return_null`,in call to `return_first`,parameter `x` of return_first,assigned,assigned,return from call to `return_first`,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "nullptr_dereference", "start_line": 73, "end_line": 79}}
{"id": "interprocedural_013", "source_file": "pulse/interprocedural.c", "original_function_name": "follow_value_by_ret_bad", "anonymized_function_name": "test_function_013", "function_code": "void test_function_013() {\n  int *dummy1, *dummy2;\n  int* y = return_null(&dummy1);\n  int* z = return_first(y, 12, &dummy2);\n  *z = 42;\n}\n", "includes": ["#include <stdlib.h>"], "dependencies": ["return_first", "return_null"], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 4, "absolute_line": 86, "severity": "ERROR", "trace": "in call to `return_null`,is assigned to the null pointer,assigned,returned,return from call to `return_null`,assigned,in call to `return_first`,parameter `x` of return_first,assigned,returned,return from call to `return_first`,assigned,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "nullptr_dereference", "start_line": 82, "end_line": 87}}
{"id": "interprocedural_014", "source_file": "pulse/interprocedural.c", "original_function_name": "malloc_wrapper_1", "anonymized_function_name": "test_function_014", "function_code": "int* test_function_014() {\n  int* x;\n  x = (int*)malloc(sizeof(int));\n  return x;\n}\n", "includes": ["#include <stdlib.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 89, "end_line": 93}}
{"id": "interprocedural_015", "source_file": "pulse/interprocedural.c", "original_function_name": "malloc_wrapper_2", "anonymized_function_name": "test_function_015", "function_code": "int* test_function_015(int b) {\n  if (b) {\n    return malloc_wrapper_1();\n  }\n  return NULL;\n}\n", "includes": ["#include <stdlib.h>"], "dependencies": ["malloc_wrapper_1"], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "safe", "start_line": 95, "end_line": 100}}
{"id": "interprocedural_016", "source_file": "pulse/interprocedural.c", "original_function_name": "free_wrapper", "anonymized_function_name": "test_function_016", "function_code": "void test_function_016(int* p, int b) {\n  if (b) {\n    free(p);\n  }\n}\n", "includes": ["#include <stdlib.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 102, "end_line": 106}}
{"id": "interprocedural_017", "source_file": "pulse/interprocedural.c", "original_function_name": "trace_correctly_through_wrappers_bad", "anonymized_function_name": "test_function_017", "function_code": "void test_function_017() {\n  int* x = malloc_wrapper_2(1);\n  // TODO: ideally we would trace that we didn't go into the free() branch of\n  // the wrapper explicitly here to help understand the bug report\n  free_wrapper(x, 0);\n}\n", "includes": ["#include <stdlib.h>"], "dependencies": ["malloc_wrapper_2", "free_wrapper"], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "MEMORY_LEAK_C", "line_offset": 4, "absolute_line": 112, "severity": "ERROR", "trace": "allocation part of the trace starts here,when calling `malloc_wrapper_2` here,when calling `malloc_wrapper_1` here,allocated by `malloc` here,memory becomes unreachable here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "memory_leak", "start_line": 108, "end_line": 113}}
