{"id": "nullptr_001", "source_file": "pulse/nullptr.c", "original_function_name": "malloc_no_check_bad", "anonymized_function_name": "test_function_001", "function_code": "int* test_function_001() {\n  int* p = (int*)malloc(sizeof(int));\n  *p = 42;\n  return p;\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 2, "absolute_line": 14, "severity": "ERROR", "trace": "in call to `malloc (null case)` (modelled),is assigned to the null pointer,assigned,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "nullptr_dereference", "start_line": 12, "end_line": 16}}
{"id": "nullptr_002", "source_file": "pulse/nullptr.c", "original_function_name": "malloc_assert_ok", "anonymized_function_name": "test_function_002", "function_code": "void test_function_002() {\n  int* p = (int*)malloc(sizeof(int));\n  assert(p);\n  *p = 42;\n  free(p);\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 18, "end_line": 23}}
{"id": "nullptr_003", "source_file": "pulse/nullptr.c", "original_function_name": "create_null_path_ok", "anonymized_function_name": "test_function_003", "function_code": "void test_function_003(int* p) {\n  if (p) {\n    *p = 32;\n  }\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 25, "end_line": 29}}
{"id": "nullptr_004", "source_file": "pulse/nullptr.c", "original_function_name": "call_create_null_path_then_deref_unconditionally_ok", "anonymized_function_name": "test_function_004", "function_code": "void test_function_004(int* p) {\n  create_null_path_ok(p);\n  *p = 52;\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": ["create_null_path_ok"], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "safe", "start_line": 31, "end_line": 34}}
{"id": "nullptr_005", "source_file": "pulse/nullptr.c", "original_function_name": "create_null_path2_bad_FN", "anonymized_function_name": "test_function_005", "function_code": "void test_function_005(int* p) {\n  int* q = NULL;\n  if (p) {\n    *p = 32;\n  }\n  // arguably bogus to check p above but not here, but the above could\n  // also be macro-generated code so both reporting and not reporting\n  // are sort of justifiable\n  *p = 52;\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 8, "absolute_line": 44, "severity": "ERROR", "trace": "*** SUPPRESSED ***,source of the null value part of the trace starts here,assigned,is assigned to the null pointer,null pointer dereference part of the trace starts here,parameter `p` of create_null_path2_bad_FN,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "nullptr_dereference", "start_line": 36, "end_line": 45}}
{"id": "nullptr_006", "source_file": "pulse/nullptr.c", "original_function_name": "nullptr_deref_young_bad", "anonymized_function_name": "test_function_006", "function_code": "void test_function_006(int* x) {\n  int* vec[65] = {x, x, x, x, x, x, x, x, x, x, x, x, x, x,   x, x, x,\n                  x, x, x, x, x, x, x, x, x, x, x, x, x, x,   x, x, x,\n                  x, x, x, x, x, x, x, x, x, x, x, x, x, x,   x, x, x,\n                  x, x, x, x, x, x, x, x, x, x, x, x, x, NULL};\n  int p = *vec[64];\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 5, "absolute_line": 65, "severity": "ERROR", "trace": "is assigned to the null pointer,assigned,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "nullptr_dereference", "start_line": 60, "end_line": 66}}
{"id": "nullptr_007", "source_file": "pulse/nullptr.c", "original_function_name": "malloc_free_ok", "anonymized_function_name": "test_function_007", "function_code": "void test_function_007() {\n  int* p = (int*)malloc(sizeof(int));\n  free(p);\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 79, "end_line": 82}}
{"id": "nullptr_008", "source_file": "pulse/nullptr.c", "original_function_name": "wrap_free", "anonymized_function_name": "test_function_008", "function_code": "void test_function_008(void* p) { free(p); }\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 84, "end_line": 84}}
{"id": "nullptr_009", "source_file": "pulse/nullptr.c", "original_function_name": "interproc_free_ok", "anonymized_function_name": "test_function_009", "function_code": "void test_function_009() {\n  int* p = (int*)malloc(sizeof(int));\n  wrap_free(p);\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": ["wrap_free"], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "safe", "start_line": 86, "end_line": 89}}
{"id": "nullptr_010", "source_file": "pulse/nullptr.c", "original_function_name": "wrap_malloc", "anonymized_function_name": "test_function_010", "function_code": "void test_function_010(int** x) {\n  *x = (int*)malloc(sizeof(int));\n  if (!*x) {\n    no_return();\n  }\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 93, "end_line": 98}}
{"id": "nullptr_011", "source_file": "pulse/nullptr.c", "original_function_name": "call_no_return_good", "anonymized_function_name": "test_function_011", "function_code": "void test_function_011() {\n  int* x = NULL;\n  wrap_malloc(&x);\n  *x = 5;\n  free(x);\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": ["wrap_malloc"], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "safe", "start_line": 100, "end_line": 105}}
{"id": "nullptr_012", "source_file": "pulse/nullptr.c", "original_function_name": "bug_after_malloc_result_test_bad", "anonymized_function_name": "test_function_012", "function_code": "void test_function_012(int* x) {\n  x = (int*)malloc(sizeof(int));\n  if (x) {\n    int* y = NULL;\n    *y = 42;\n  }\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 4, "absolute_line": 111, "severity": "ERROR", "trace": "is assigned to the null pointer,assigned,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "nullptr_dereference", "start_line": 107, "end_line": 113}}
{"id": "nullptr_013", "source_file": "pulse/nullptr.c", "original_function_name": "bug_after_abduction_bad", "anonymized_function_name": "test_function_013", "function_code": "void test_function_013(int* x) {\n  *x = 42;\n  int* y = NULL;\n  *y = 42;\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 3, "absolute_line": 118, "severity": "ERROR", "trace": "is assigned to the null pointer,assigned,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "nullptr_dereference", "start_line": 115, "end_line": 119}}
{"id": "nullptr_014", "source_file": "pulse/nullptr.c", "original_function_name": "bug_with_allocation_bad", "anonymized_function_name": "test_function_014", "function_code": "void test_function_014(int* x) {\n  x = (int*)malloc(sizeof(int));\n  int* y = NULL;\n  *y = 42;\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 3, "absolute_line": 124, "severity": "ERROR", "trace": "is assigned to the null pointer,assigned,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "nullptr_dereference", "start_line": 121, "end_line": 125}}
{"id": "nullptr_015", "source_file": "pulse/nullptr.c", "original_function_name": "null_alias_bad", "anonymized_function_name": "test_function_015", "function_code": "void test_function_015(int* x) {\n  int* y = NULL;\n  x = (int*)malloc(sizeof(int*));\n  *x = 42;\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "MEMORY_LEAK_C", "line_offset": 3, "absolute_line": 130, "severity": "ERROR", "trace": "allocation part of the trace starts here,allocated by `malloc` here,memory becomes unreachable here"}, {"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 3, "absolute_line": 130, "severity": "ERROR", "trace": "in call to `malloc (null case)` (modelled),is assigned to the null pointer,assigned,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "nullptr_dereference", "start_line": 127, "end_line": 131}}
{"id": "nullptr_016", "source_file": "pulse/nullptr.c", "original_function_name": "dereference", "anonymized_function_name": "test_function_016", "function_code": "void test_function_016(int* p) { int i = *p; }\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 133, "end_line": 133}}
{"id": "nullptr_017", "source_file": "pulse/nullptr.c", "original_function_name": "several_dereferences_ok", "anonymized_function_name": "test_function_017", "function_code": "void test_function_017(int* x, int* y, int* z) {\n  int* p = x;\n  *z = 52;\n  dereference(y);\n  *y = 42;\n  *x = 32;\n  *x = 777;\n  *y = 888;\n  *z = 999;\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": ["dereference"], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "safe", "start_line": 135, "end_line": 144}}
{"id": "nullptr_018", "source_file": "pulse/nullptr.c", "original_function_name": "report_correct_error_among_multiple_bad", "anonymized_function_name": "test_function_018", "function_code": "void test_function_018() {\n  int* p = NULL;\n  // the trace should complain about the first access inside the callee\n  several_dereferences_ok(p, p, p);\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": ["several_dereferences_ok"], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 3, "absolute_line": 149, "severity": "ERROR", "trace": "is assigned to the null pointer,assigned,when calling `several_dereferences_ok` here,parameter `z` of several_dereferences_ok,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "nullptr_dereference", "start_line": 146, "end_line": 150}}
{"id": "nullptr_019", "source_file": "pulse/nullptr.c", "original_function_name": "unknown_is_functional_ok", "anonymized_function_name": "test_function_019", "function_code": "void test_function_019() {\n  int* p = NULL;\n  if (unknown(10) != unknown(10)) {\n    *p = 42;\n  }\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 154, "end_line": 159}}
{"id": "nullptr_020", "source_file": "pulse/nullptr.c", "original_function_name": "unknown_with_different_values_bad", "anonymized_function_name": "test_function_020", "function_code": "void test_function_020() {\n  int* p = NULL;\n  if (unknown(32) != unknown(52)) {\n    *p = 42;\n  }\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 3, "absolute_line": 164, "severity": "ERROR", "trace": "is assigned to the null pointer,assigned,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "nullptr_dereference", "start_line": 161, "end_line": 166}}
{"id": "nullptr_021", "source_file": "pulse/nullptr.c", "original_function_name": "unknown_conditional_dereference", "anonymized_function_name": "test_function_021", "function_code": "void test_function_021(int x, int* p) {\n  if (unknown(x) == 999) {\n    *p = 42;\n  }\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 168, "end_line": 172}}
{"id": "nullptr_022", "source_file": "pulse/nullptr.c", "original_function_name": "unknown_from_parameters_latent", "anonymized_function_name": "test_function_022", "function_code": "void test_function_022(int x) {\n  unknown_conditional_dereference(x, NULL);\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": ["unknown_conditional_dereference"], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE_LATENT", "line_offset": 1, "absolute_line": 175, "severity": "ERROR", "trace": "is assigned to the null pointer,when calling `unknown_conditional_dereference` here,parameter `p` of unknown_conditional_dereference,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "other", "start_line": 174, "end_line": 176}}
{"id": "nullptr_023", "source_file": "pulse/nullptr.c", "original_function_name": "random_non_functional_bad", "anonymized_function_name": "test_function_023", "function_code": "void test_function_023() {\n  if (random() != random()) {\n    int* p = NULL;\n    *p = 42;\n  }\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 3, "absolute_line": 182, "severity": "ERROR", "trace": "is assigned to the null pointer,assigned,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "nullptr_dereference", "start_line": 179, "end_line": 184}}
{"id": "nullptr_024", "source_file": "pulse/nullptr.c", "original_function_name": "random_modelled_bad", "anonymized_function_name": "test_function_024", "function_code": "void test_function_024(int y) {\n  int x = random();\n  if (x == y) {\n    int* p = NULL;\n    *p = 42;\n  }\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 4, "absolute_line": 190, "severity": "ERROR", "trace": "is assigned to the null pointer,assigned,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "nullptr_dereference", "start_line": 186, "end_line": 192}}
{"id": "nullptr_025", "source_file": "pulse/nullptr.c", "original_function_name": "arithmetic_weakness_ok", "anonymized_function_name": "test_function_025", "function_code": "void test_function_025() {\n  int x = random();\n  int y = random();\n  if (x < y && x > y) {\n    int* p = NULL;\n    *p = 42;\n  }\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 194, "end_line": 201}}
{"id": "nullptr_026", "source_file": "pulse/nullptr.c", "original_function_name": "no_invalidation_compare_to_NULL_bad", "anonymized_function_name": "test_function_026", "function_code": "void test_function_026() {\n  int* p = unknown_int_pointer();\n  int x;\n  int* q = &x;\n  if (p == NULL) {\n    q = p;\n  }\n  *q = 42;\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "COMPARED_TO_NULL_AND_DEREFERENCED", "line_offset": 7, "absolute_line": 212, "severity": "ERROR", "trace": "compared to null here,in call to function `unknown_int_pointer` with no summary,assigned,was compared to null on line 209, column 7,assigned,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "other", "start_line": 205, "end_line": 213}}
{"id": "nullptr_027", "source_file": "pulse/nullptr.c", "original_function_name": "incr_deref", "anonymized_function_name": "test_function_027", "function_code": "void test_function_027(int* x, int* y) {\n  (*x)++;\n  (*y)++;\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": [], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": false, "category": "safe", "start_line": 215, "end_line": 218}}
{"id": "nullptr_028", "source_file": "pulse/nullptr.c", "original_function_name": "call_incr_deref_with_alias_bad", "anonymized_function_name": "test_function_028", "function_code": "void test_function_028(void) {\n  int x = 0;\n  int* ptr = &x;\n  incr_deref(ptr, ptr);\n  if (x == 2) {\n    ptr = NULL;\n  }\n  x = *ptr;\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": ["incr_deref"], "ground_truth": {"has_bug": true, "bugs": [{"bug_type": "NULLPTR_DEREFERENCE", "line_offset": 7, "absolute_line": 227, "severity": "ERROR", "trace": "is assigned to the null pointer,assigned,invalid access occurs here"}]}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "nullptr_dereference", "start_line": 220, "end_line": 228}}
{"id": "nullptr_029", "source_file": "pulse/nullptr.c", "original_function_name": "call_incr_deref_with_alias_good", "anonymized_function_name": "test_function_029", "function_code": "void test_function_029(void) {\n  int x = 0;\n  int* ptr = &x;\n  incr_deref(ptr, ptr);\n  if (x != 2) {\n    ptr = NULL;\n  }\n  x = *ptr;\n}\n", "includes": ["#include <assert.h>", "#include <stdlib.h>", "#include <stdnoreturn.h>"], "dependencies": ["incr_deref"], "ground_truth": {"has_bug": false, "bugs": []}, "metadata": {"difficulty": "advanced", "requires_interprocedural": true, "category": "safe", "start_line": 230, "end_line": 238}}
